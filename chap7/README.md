## フレームワークを作ってみる

### 要件

- MVCモデルによる役割の管理
- データベースへの接続方法
- ログイン状態の管理
- ルーティング機能
- CSRF対策

 ### クラスの役割
 
 
- **Request**
  - ユーザのリクエストを表すクラス。ユーザがリクエストした際の`GET`や`POST`パラメータURLを管理します。
- **Router**
  - ユーザがアクセサしたURLをRequestクラスから受け取り、どのコントローラを呼び出すかを決定します。
  - これにより物理的なディレクトリ構造に縛られないURL制御を可能にします。
- **Response**
  - リクエストに対するレスポンスです。最終的にユーザへ返すレスポンスの情報を管理します。
- **DbManager**
  - データベースへの接続情報や次に説明するDbRepositoryを管理するクラスです。
- **DbRepository**
  - 実際にデータベースのアクセスを伴う処理を管理するクラスです。
  - データベース上のテーブルごとにDbRepositoryクラスの子クラスを作成します。
  - 今回のフレームワークでは__モデル__に相当します。
- **Controller**
  - __モデル__や__ビュー__の制御を行うコントローラです。今回はこのControllerクラスの中に__アクション__と呼ばれるメソッドを定義していきます。
    アクションが実際に1画面に相当します。具体的な例を出すと、ユーザ情報を扱うコントローラをUserContollerクラスとして作成し、その中でユーザに対するアクション、例えばユーザ情報編集ならばeditAction(),ユーザ追加ならnewAction()というメソッドを定義していきます。
- **View**
  - 表示を制御するクラスです。ViewクラスにHTMLを書くわけではなく、HTMLが記述されたファイルの読み込みや変数の受け渡しをを行います。
  - Viewクラスが表示を扱うクラス
  - ViewファイルがHTMLファイルそのものを指す
- **Session**
  - [セッション](https://qiita.com/7968/items/ce03feb17c8eaa6e4672#%E7%AC%AC2%E7%AB%A0-%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6)を管理するクラスです。
- **Application**
  - アプリケーション全体を表すクラスです。RequestクラスやSessionクラスの初期化、コントローラの実現などアプリケーションの全体の流れを管理します。
    アプリケーションごとにこのクラスを継承したクラスを定義し、アプリケーション固有の設定(データベース接続情報、URLとコントローラの対応など)の定義を行います。データベースの接続情報はDbManagerクラスにURLとコントローラの対応はRouteクラスにそれぞれ設定します。
- **ClassLoader**
  - クラスを定義したファイルを自動的に読み込むための__オーバロード__と言う仕組みを管理するクラス。オートローダとはクラスが必要な時に読み込むための仕組みです。定義されていないクラスを使おうとする時に、指定されたオートロード関数が呼び出されます。開発者はオートローダ関数の実装を適切にすることで、クラスが必要とされたタイミングで適切なクラスを読み込む処理を記述する事が可能である。
  - `__autload()`関数でもクラスやインターファイスのオーバロードが出来ますが,`spl_autoload_register()`関数が有効です。


### 参考資料

- [PHP: クラスのオートローディング - Manual](http://php.net/manual/ja/language.oop5.autoload.php)
